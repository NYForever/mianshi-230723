
# 面试资料整理


## java基础
#### [java基础](./1-jichu.md)

### 锁
#### [锁相关](./2-lock.md)

### 线程
#### [线程相关](./3-Thread.md)


### 动态代理
- 1.jdk动态代理和cglib的区别什么，实现原理是什么


## JVM虚拟机
- 1.分析工具有哪些，具体怎么进行性能调优
- 2.垃圾回收算法有哪些，有什么优缺点，gcroot有哪些？
- 3.什么情况下yongGc，什么时候fullGc，jvm中一次完整的GC流程是什么样的
- 4.内存结构是什么样的，常量在哪，变量在哪，哪些是共享的，哪些是线程私有的
- 5.什么时候会StackOverFlowError/OOM，服务OOM怎么办，如何排查
- 6.G1垃圾回收
- 7.双亲委派机制是什么，怎么将两个全路径相同的类加载到内存中
```
双亲委派机制是Java中的一种类加载机制。它基于父子关系的层次结构，将类加载的责任逐级向上委托给父类加载器，直到顶层的启动类加载器。只有在父类加载器无法找到所需的类时，子类加载器才会尝试自己加载。

具体来说，当一个类加载器收到类加载请求时，它会首先检查是否已经加载过该类。如果已经加载，则直接返回已加载的类。如果没有加载过，它会将类加载请求传递给其父类加载器。父类加载器也会按照相同的方式检查是否已经加载过该类，并依次传递给自己的父类加载器。这样一直往上追溯，直到达到顶层的启动类加载器（Bootstrap Class Loader）为止。

这个机制的优势在于避免了重复加载相同的类，确保类的唯一性和一致性。同时，它还提供了一种安全机制，防止恶意代码通过自定义类加载器来替换核心类库中的类。

在将两个全路径相同的类加载到内存中时，如果使用不同的类加载器加载，它们被视为不同的类。因为类加载器通过命名空间来区分加载的类，每个类加载器都有自己的命名空间。所以，使用不同的类加载器加载相同全路径的类会导致在内存中存在多个相同名称但彼此独立的类对象。

如果要在内存中加载两个全路径相同的类实例来避免冲突，可以通过创建两个不同的类加载器，并分别使用它们来加载这两个类。这样做可以使它们在内存中成为不同的类对象，避免类冲突。
```


## 数据库
### mysql
- 1.优化sql的思路有哪些
- 2.索引的结构，索引是越多越好吗？
- 3.聚簇索引、覆盖索引是什么
- 4.mysql表不指定主键会怎么样，会帮我们自动生成吗？自动生成的主键有什么问题？
```
在MySQL中，如果你创建表时没有显式指定主键（Primary Key），MySQL会为你自动生成一个隐含的主键。这个隐含的主键是一个称为"隐藏列"（Hidden Column）或"虚拟列"（Virtual Column）的列，它包含一个递增的整数值。

这个隐含的主键列是InnoDB存储引擎特有的实现方式，并且它具有以下特点：

1. 自动递增：每插入一行数据，隐含的主键值会自动递增。

2. 唯一性：隐含的主键值在表中必须是唯一的，确保每一行都有一个唯一标识。

3. 非空性：隐含的主键列被定义为非空，所以每一行都必须有一个有效的主键值。

需要注意的是，使用隐含的主键可能会导致一些问题：

1. 无法显示控制主键的命名和数据类型：隐含的主键列的名称是固定的，通常为`rowid`或`id`。此外，你无法显式指定主键列的数据类型。

2. 索引效率较低：由于隐含的主键是递增的整数值，而不是根据其他列的实际值计算得出的，因此可能会导致索引效率较低。

因此，建议在创建表时显式指定主键，并根据实际业务需求选择合适的列作为主键。显式指定主键可以提高查询效率、确保数据完整性，并允许你更好地控制主键的命名和数据类型。
```
- 5.分库分表怎么实现，分表后怎么做分页查询，怎么做到不停机扩容，双写数据丢失怎么办，跨库事物怎么解决
```
分库分表的实现方式可以分为垂直分库和水平分库两种。下面是关于分库分表以及相关问题的解决方法：

1. 分库分表的实现：
   - 垂直分库：按照业务功能将不同的数据表分配到不同的数据库中，每个数据库专注于处理自己的数据。
   - 水平分库：按照某个规则（如哈希、范围等）将数据划分为多个逻辑分片，分布在不同的数据库实例中。
   - 水平分表：根据某个规则将表中的行数据划分到多个物理表中，每个表只包含部分数据。

2. 分表后的分页查询：
   在分表的情况下，进行分页查询需要在各个分表上执行单独的查询，然后将结果进行合并排序和截取返回指定页的数据。这可以通过在应用层实现或使用分布式查询工具来处理。

3. 不停机扩容：
   - 分库扩容：引入新的数据库节点，通过迁移一部分数据到新节点，逐步完成扩容操作。同时，需要修改应用程序的配置文件来适应新的数据库连接信息。
   - 分表扩容：创建新的物理表，并将部分数据迁移到新表上。然后，通过修改应用程序的访问逻辑来支持新表的使用。

4. 双写数据丢失：
   - 异步复制：将数据异步复制到从库。即使主从库之间存在网络故障或从库宕机，主库仍然可以正常写入数据。
   - 同步复制：保证数据的一致性和可靠性，主库写入数据后等待所有从库确认写入成功才返回结果。这可能会影响系统性能和吞吐量。

5. 跨库事务解决：
   - 强一致性方案：使用分布式事务管理器（如XA协议）来实现跨库事务的强一致性。涉及多个数据库的协调和状态管理，需要每个数据库支持XA事务。
   - 最终一致性方案：如果不要求强一致性，可以采用最终一致性的方案，如将跨库事务拆分为独立的本地事务，并通过消息队列或事件通知达到最终一致性。

分库分表架构设计需要根据具体业务需求进行权衡和选择，同时还需要考虑数据迁移、负载均衡、容灾备份等方面的问题。
```
- 6.间隙锁的策略是什么，前开后闭？
- 7.事物的隔离级别有哪些？可以用可重复度的隔离级别避免幻读吗？
- 8.binlog redolog undolog的作用是什么
- 9.mysql索引失效的情况
- 10.InnoDB和MyISAM的区别
- 11.explain关键字解析sql，各指标代表的含义

### redis
- 1.缓存穿透是什么？怎么解决？
- 2.布隆过滤器，怎么使用，有什么问题，怎么解决
- 3.怎么理解数据的幂等性，redis可以做吗？数据过期了怎么办
- 4.限流算法有哦哪些，漏桶算法和令牌算法的区别
- 5.redis分布式锁怎么实现，zk怎么实现，各有什么缺点
- 6.redis的数据结构有哪些
- 7.redis的数据淘汰机制
- 8.redis的持久化策略
- 9.什么情况下会发生雪崩，如何解决
- 10.redis为什么快？epoll是什么，和其他俩个IO复用的区别是什么
- 11.如何用redis实现朋友圈点赞、评论功能，redis数据没了怎么办
- 12.如何保证数据库与redis缓存一致

## 开源框架
### Spring
- 1.spring AOP是怎么实现的，怎么使用，
- 2.spring Bean的生命周期，循环依赖spring是怎么解决的

### Mybatis
- 1.看过源码吗？底层如何实现的？


## 中间件
### RocketMQ
- 1.事物消息的执行流程
- 2.如何实现顺序消费？一定要单消费者吗

### kafka
- 1.kafka是怎么保证高可用的，讲讲他的设计架构，为什么读写都在主分区，有什么优缺点
```
Kafka通过其设计架构和一些关键特性来保证高可用性。下面是关于Kafka高可用性的简要概述及其设计原则：

1. 分布式架构：Kafka采用分布式架构，允许在多个服务器或节点上部署多个副本。这样可以实现数据的冗余备份，以提供故障容错和高可用性。

2. 主从复制：Kafka使用主从复制的机制，将每个主题（Topic）的分区（Partition）复制到多个副本中。其中一个副本被指定为领导者（Leader），负责处理读写请求，而其他副本作为追随者（Follower）进行备份。

3. Leader-Follower同步：Kafka的领导者副本负责处理所有的读写请求，并将写入操作复制到追随者副本。追随者副本按照领导者副本的进度来进行数据同步，确保数据的一致性。只有当所有的追随者副本都成功同步数据后，才认为写入操作完成。

4. 分区负载均衡：每个主题可以被划分成多个分区，而每个分区只能有一个领导者副本。Kafka会自动进行分区负载均衡，将不同分区的领导者副本分布在不同的节点上，以实现负载均衡和高吞吐量。

读写都在主分区的优点和缺点如下：

优点：
- 简化设计：在单一的领导者副本上进行读写操作可以简化系统设计和实现。
- 减少数据复制：只需将写入操作复制到追随者副本即可，减少了无效的数据复制操作。
- 低延迟：由于读写操作只需要在一个副本上完成，所以具有较低的读写延迟。

缺点：
- 单点故障：如果主分区发生故障，整个分区将不可用，可能会影响系统的可用性。
- 读取瓶颈：所有的读取请求都必须通过主分区处理，可能导致主分区成为瓶颈，限制系统的读取吞吐量。
- 数据不一致：当主分区写入成功但尚未同步到所有追随者副本时，出现故障将导致数据不一致的情况。

总体而言，Kafka选择将读写操作集中在主分区是为了简化设计和降低延迟，并且利用主从复制机制来提供高可用性。然而，这种设计也带来了一些潜在的问题，如单点故障和读取瓶颈。为了解决这些问题，Kafka提供了故障转移机制和负载均衡策略，以实现更高级别的可用性和性能。
```
- 2.kafka的零拷贝怎么实现
- 3.kafka的reBalance raft算法
- 4.如何实现顺序消费？一定要单消费者吗

### es
- 1.es的查询写入过程，底层实现，为什么这么设计
- 2.es集群脑裂问题，怎么产生的，怎么解决


### nacos&zk的区别是什么
- 1.nacos和zk的区别是什么
- 2.什么是CAP，为什么不能同时满足，redis是AP还是CP，nacos呢？zk呢？

## 算法
- 1.雪花算法
- 2.最长回文子串
- 3.LRU算法怎么实现


## Linux
- 1.cpu 100%怎么排查
- 2.linux大文件，怎么查看某一行的内容
- 3.linux的常用命令有哪些

## 架构设计
- 1.高并发架构的设计思路
- 2.限流降级熔断的区别是什么

## 网络通讯
### grpc 

- 1.protobuf底层是什么样的
- 2.

### TCP
- 1.IP协议在哪一层
- 2.TCP中拥塞控制和流量控制的区别是什么
- 3.TCP和UDP的区别在哪
- 4.浏览器输入URL后，解析到页面渲染中间都发生了什么
- 5.两台服务器之间可以同时建立多条TCP链接吗，怎么实现的


## 思维拓展 & 问题实践
- 1.假如有10亿个手机号，怎么快速判断一个手机号是否在其中